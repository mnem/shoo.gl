(function(){var t,e=[].slice;t=namespace("shoogl.scene.generators.faux"),t.Connection=function(){function t(){var t,n,s,o,i;o=arguments[0],n=arguments[1],t=3<=arguments.length?e.call(arguments,2):[],this.output=o,this.input=n,this.name="Connection",i="<null>",null!=this.output&&(i=this.output.name),s="<null>",null!=this.input&&(s=this.input.name),this.description="Connecting "+i+" to "+s,this["in"]={},this.out={},null!=this.output&&null!=this.input?(this["in"]=this.output["in"],this.out=this.input.out,0===t.length?this._automatch_connection():this._create_connections(t)):this.output_to_input_map={}}return t.prototype.update=function(){var t,e,n,s;null!=this.output&&this.output.update(),s=this.output_to_input_map;for(e in s)t=s[e],n=shoogl.scene.generators.TypeTools.type_string(e),"v2"===n||"v3"===n||"v4"===n?this.input["in"][t].copy(this.output.out[e]):this.input["in"][t]=this.output.out[e];return null!=this.input?this.input.update():void 0},t.prototype._create_connections=function(t){var e,n,s,o,i,r,u,a,l,h;for(this.output_to_input_map={},e=shoogl.scene.generators.TypeTools,i=e.first_generator_output(this.output,"timestamp"),i&&t.push("timestamp:"),h=[],a=0,l=t.length;l>a;a++)r=t[a],n=r.split(":"),2===n.length?(o=n[0],s=n[1],o&&!s?(u=e.type_string(o),s=e.first_generator_input(this.input,u)):!o&&s?(u=e.type_string(s),o=e.first_generator_output(this.output,u)):o||s||(o=e.first_generator_output(this.output),u=e.type_string(o),s=e.first_generator_input(this.input,u)),null!=this.output.out[o]&&null!=this.input["in"][s]?h.push(this.output_to_input_map[o]=s):h.push(void 0)):h.push(void 0);return h},t.prototype._automatch_connection=function(){var t,e,n,s,o,i,r;this.output_to_input_map={},t=shoogl.scene.generators.TypeTools,i=this.output.out,r=[];for(n in i)o=i[n],s=t.type_string(n),e=t.first_generator_input(this.input,s),e?r.push(this.output_to_input_map[n]=e):r.push(void 0);return r},t}()}).call(this),function(){var t;t=namespace("shoogl.scene.generators"),t.TypeTools=function(){function t(){}return t.type_string=function(t){var e,n;return n="",null!=t&&(e=t.split("_"),e.length>0&&(n=e.pop())),n},t.is_array=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},t.types_equal=function(t,e){var n,s;return n=this.type_string(t),s=this.type_string(e),null!=n&&n===s},t.first_generator_output=function(t,e){return null==e&&(e=null),null==t?"":this.first_slot(t.out,e)},t.first_generator_input=function(t,e){return null==e&&(e=null),null==t?"":this.first_slot(t["in"],e)},t.first_slot=function(t,e){var n,s,o,i,r,u;if(null==e&&(e=null),null==t)return"";s=[];for(n in t)i=t[n],s.push(n);for(s.sort(),o=null,o=null===e?new RegExp(".*"):new RegExp(".*_"+e+"$"),r=0,u=s.length;u>r;r++)if(n=s[r],o.test(n))return n;return""},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.CopyGenerator=function(){function t(){this["in"]={value_f:0},this.out={value_f:0},this.name="Copy generator",this.description="Copies a value"}return t.prototype.update=function(){return this.out.value_f=this["in"].value_f},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.CosineGenerator=function(){function t(){this["in"]={value_f:0,hertz_f:1},this.out={result_f:0},this.name="Cosine generator",this.description="Uses the input value and hertz frequency to generate a cosine output value."}return t.prototype.update=function(){return this.out.result_f=Math.cos(this["in"].value_f*this["in"].hertz_f)},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.FibonacciGenerator=function(){function t(){this["in"]={index_i:0,maximum_index_i:46},this.out={value_i:0},this.name="Fibonacci generator",this.description="Calculates the n-th Fibonacci number, where f(0) = 0 and f(1) = 1"}return t.prototype.update=function(){var t;return t=Math.floor(this["in"].index_i)%Math.floor(this["in"].maximum_index_i+1),this.out.value_i=this.fib(t)},t.prototype.fib=function(t){var e,n,s,o,i;for(n=-1,s=1,e=i=0;t>=0?t>=i:i>=t;e=t>=0?++i:--i)o=s+n,n=s,s=o;return s},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.FloatArrayDomOutputGenerator=function(){function t(){var t,e=this;this["in"]={value_f:[],last_update_timestamp:0},t=$('<span class="array"></span>'),this._summary=$("<span></span>"),this._elements=$("<div></div>"),$(t).append(this._summary),$(t).append(this._elements),$(this._summary).removeClass("hidden"),$(this._elements).addClass("hidden"),$(t).on("mousedown",function(){return $(e._summary).hasClass("hidden")?($(e._summary).removeClass("hidden"),$(e._elements).addClass("hidden")):($(e._summary).addClass("hidden"),$(e._elements).removeClass("hidden"))}),this.out={output_dom:t},this.element_doms=[],this.name="Float array DOM element",this.description="DOM element which displays an array of float values"}return t.prototype.update=function(){var t,e,n,s,o,i,r,u,a,l;if(null!=(o=this["in"])?o.value_f:void 0){if(this.element_doms.length<this["in"].value_f.length)for(this.element_doms.length=this["in"].value_f.length,t=e=0,i=this.element_doms.length;i>=0?i>e:e>i;t=i>=0?++e:--e)null==this.element_doms[t]&&(this.element_doms[t]={index_dom:$('<span class="index"></span>'),value_dom:$('<span class="number"></span>')},$(this._elements).append(this.element_doms[t].index_dom,this.element_doms[t].value_dom));else if(this.element_doms.length>this["in"].value_f.length){for(t=n=r=this["in"].value_f.length,u=this.element_doms.length;u>=r?u>n:n>u;t=u>=r?++n:--n)null!=this.element_doms[t]&&($(this.element_doms[t].index_dom).remove(),$(this.element_doms[t].value_dom).remove());this.element_doms.length=this["in"].value_f.length}if(this["in"].last_update_timestamp!==this._last_update_timestamp){for(this._last_update_timestamp=this["in"].last_update_timestamp,$(this._summary).text("Number of vertices: "+this["in"].value_f.length),l=[],t=s=0,a=this["in"].value_f.length;a>=0?a>s:s>a;t=a>=0?++s:--s)$(this.element_doms[t].index_dom).text(""+t),l.push($(this.element_doms[t].value_dom).text(""+this["in"].value_f[t].toFixed(4)+" "));return l}}},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.FloatDomOutputGenerator=function(){function t(){var t;this["in"]={value_f:0},t=$('<span class="number"></span>'),$(t).on("mouseover",function(){return $(t).addClass("mouseover")}),$(t).on("mouseout",function(){return $(t).removeClass("mouseover")}),this.out={output_dom:t},this.name="Float DOM element",this.description="DOM element which displays a float value"}return t.prototype.update=function(){var t,e;if(null!=(null!=(e=this["in"])?e.value_f:void 0))return t=$(this.out.output_dom).hasClass("mouseover")?""+this["in"].value_f:this["in"].value_f.toFixed(4),$(this.out.output_dom).text(t)},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.Object3DPositionGenerator=function(){function t(){this["in"]={source_object3d:null},this.out={result_v3:new THREE.Vector3(0,0,0)},this.name="Object3D position",this.description="Generates a Vector3 corresponding to the source object's world position"}return t.prototype.update=function(){return null!=this["in"].source_object3d?this.out.result_v3.setFromMatrixPosition(this["in"].source_object3d.matrixWorld):void 0},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.RandomGenerator=function(){function t(){this["in"]={},this.out={result_f:0},this.name="Random generator",this.description="Generates a random number between 0 (inclusive) and 1 (exclusive)"}return t.prototype.update=function(){return this.out.result_f=Math.random()},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.SineGenerator=function(){function t(){this["in"]={value_f:0,hertz_f:1},this.out={result_f:0},this.name="Sine generator",this.description="Uses the input value and hertz frequency to generate a sine output value."}return t.prototype.update=function(){return this.out.result_f=Math.sin(this["in"].value_f*this["in"].hertz_f)},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.TextVector2Generator=function(){function t(){this["in"]={value_string:"0 0"},this.out={result_v2:new THREE.Vector2(0,0)},this.name="Vector2 generator",this.description="Generates a Vector3 "}return t.prototype.update=function(){var t,e,n;if(null!=this["in"].value_string&&(t=this["in"].value_string.split(" "),2===t.length))return e=Number(t[0])||0,n=Number(t[1])||0,this.out.result_v2.set(e,n)},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.TextVector3Generator=function(){function t(){this["in"]={value_string:"0 0 0"},this.out={result_v3:new THREE.Vector3(0,0,0)},this.name="Vector3 generator",this.description="Generates a Vector3 "}return t.prototype.update=function(){var t,e,n,s;if(null!=this["in"].value_string&&(t=this["in"].value_string.split(" "),3===t.length))return e=Number(t[0])||0,n=Number(t[1])||0,s=Number(t[2])||0,this.out.result_v3.set(e,n,s)},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.standard"),t.TimeGenerator=function(){function t(){this["in"]={},this.out={seconds_f:0},this.name="Time generator",this.description="Seconds since 1 January 1970 00:00:00 UTC."}return t.prototype.update=function(){return this.out.seconds_f=Date.now()/1e3},t}()}.call(this),function(){var t,e=[].slice;t=namespace("shoogl.scene.generators.standard"),t.Vector3DomOutputGenerator=function(){function t(){var t;this["in"]={value_v3:new THREE.Vector3(0,0,0)},t=$("<span></span>"),$(t).addClass("threetype-v threetype-v3"),this._x_span=this._make_component_dom("x","r","number"),this._y_span=this._make_component_dom("y","g","number"),this._z_span=this._make_component_dom("z","b","number"),$(t).append(this._x_span,this._y_span,this._z_span),this.out={output_dom:t},this.name="Float DOM element",this.description="DOM element which displays a float value"}return t.prototype.update=function(){var t;if(null!=(null!=(t=this["in"])?t.value_v3:void 0))return this._format_value(this["in"].value_v3.x,this._x_span),this._format_value(this["in"].value_v3.y,this._y_span),this._format_value(this["in"].value_v3.z,this._z_span)},t.prototype._format_value=function(t,e){var n;return n=$(e).hasClass("mouseover")?""+t:t.toFixed(4),$(e).text(""+n+" ")},t.prototype._make_component_dom=function(){var t,n;return t=1<=arguments.length?e.call(arguments,0):[],n=$("<span></span>"),$(n).addClass(t.join(" ")),$(n).on("mouseover",function(){return $(n).addClass("mouseover")}),$(n).on("mouseout",function(){return $(n).removeClass("mouseover")}),n},t}()}.call(this),function(){var t;t=namespace("shoogl.scene.generators.faux"),t.VertexIndexMap=function(){function t(t,e,n){var s,o,i;this.generator=t,this.generator_input=null!=e?e:null,this.generator_output=null!=n?n:null,this.name="VertexIndexMap",this.description=null!=this.generator?"Creates a map from vertex index to value generated by "+this.generator.name:"Creates a map from vertex index to value",(null==this.generator_input||null==(null!=(o=this.generator)?o["in"][this.generator_input]:void 0))&&(this.generator_input=shoogl.scene.generators.TypeTools.first_generator_input(this.generator,"i")),null==(null!=(i=this.generator)?i["in"][this.generator_input]:void 0)&&(this.generator_input=shoogl.scene.generators.TypeTools.first_generator_input(this.generator,"f")),null!=this.generator_output&&this.generator.out[this.generator_output]||(this.generator_output=shoogl.scene.generators.TypeTools.first_generator_output(this.generator)),this["in"]={source_geometry:null,updates_per_second:0},s=shoogl.scene.generators.TypeTools.type_string(this.generator_output),this._output_name="index_map_"+s,this.out={last_update_timestamp:Date.now()},this.out[this._output_name]=[],this._next_update=0}return t.prototype.update=function(){var t,e,n,s,o,i,r,u,a;if(null!=this["in"].source_geometry&&null!=(null!=(a=this.generator)?a.out[this.generator_output]:void 0)&&(s=this["in"].source_geometry.vertices.length,o=this.out[this._output_name],e=s!==o.length,this["in"].updates_per_second>0?(this._next_update!==this._next_update&&(this._next_update=0),n=Date.now(),n>=this._next_update&&(e=!0,i=1e3*this["in"].updates_per_second,r=i-(n-this._next_update),0>r&&(r=0),r>i&&(r=i),this._next_update=n+r)):this._last_update=0,e)){for(o.length=s,t=u=0;s>=0?s>u:u>s;t=s>=0?++u:--u)this.generator_input&&(this.generator["in"][this.generator_input]=t),this.generator.update(),o[t]=this.generator.out[this.generator_output];return this.out.last_update_timestamp=Date.now()}},t}()}.call(this),function(){var t,e=[].slice;t=namespace("shoogl.scene.generators"),t.GeneratorList=function(){function t(){var t,n;n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],this.title=n,this.title||(this.title=""),this.dom=$("<div class='generator-list'><h1>"+this.title+"</h1></div>"),(null!=t?t.length:void 0)>0&&this.dom.addClass(t.join(" ")),this._dom_list=$("<ul></ul>"),$(this.dom).append(this._dom_list),this._items=[]}return t.prototype.add=function(){var t,n,s,o,i,r,u,a,l,h,p,_,c,m,d;if(c=arguments[0],l=2<=arguments.length?e.call(arguments,1):[],c&&l.length>=1){if(o=[],t=shoogl.scene.generators.faux.Connection,r=[],u=l[l.length-1],a=null,l.length>=2)for(_=m=0,d=l.length-1;d>=0?d>m:m>d;_=d>=0?++m:--m)"string"!=typeof l[_]&&(u=l[_]),"string"==typeof l[_+1]?r.push(l[_+1]):(a=l[_+1],s=function(t,e,n){n.prototype=t.prototype;var s=new n,o=t.apply(s,e);return Object(o)===o?o:s}(t,[u,a].concat(e.call(r)),function(){}),o.push(s),r.length=0);return"string"==typeof l[l.length-1]?r.push(l[l.length-1]):u=l[l.length-1],a=null,n=shoogl.scene.generators.TypeTools,h=n.first_generator_output(u,"f"),p=n.first_generator_output(u,"v3"),h?a=n.is_array(u.out[h])?new shoogl.scene.generators.standard.FloatArrayDomOutputGenerator:new shoogl.scene.generators.standard.FloatDomOutputGenerator:p?a=new shoogl.scene.generators.standard.Vector3DomOutputGenerator:(console.error("Cannot show output for "+u.name,u),console.log("Cannot show output for "+u.name,u)),i=$("<li><h2>"+c+"</h2></li>"),null!=a&&(s=function(t,e,n){n.prototype=t.prototype;var s=new n,o=t.apply(s,e);return Object(o)===o?o:s}(t,[u,a].concat(e.call(r)),function(){}),o.push(s),$(i).append(a.out.output_dom)),$(this._dom_list).append(i),this._items.push({name:c,connectors:o,generator:u,generator_output:h||p,generator_type:n.type_string(h||p)})}},t.prototype.find=function(t){var e,n,s,o;for(o=this._items,n=0,s=o.length;s>n;n++)if(e=o[n],e.name===t&&e.connectors.length>0)return e.connectors[0];return null},t.prototype.to_three_type_object=function(){var t,e,n,s;for(this._three_typed_object||(this._three_typed_object={}),s=this._items,e=0,n=s.length;n>e;e++)t=s[e],this._three_typed_object[t.name]={type:t.generator_type,value:t.generator.out[t.generator_output]};return this._three_typed_object},t.prototype.update=function(){var t,e,n,s,o,i;for(o=this._items,i=[],n=0,s=o.length;s>n;n++)e=o[n],i.push(function(){var n,s,o,i;for(o=e.connectors,i=[],n=0,s=o.length;s>n;n++)t=o[n],i.push(t.update());return i}());return i},t}()}.call(this);